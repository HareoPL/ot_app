<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ESP32-C6 application</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --bg: #f8f9fa;
            --card-bg: #fff;
            --border: #e5e7eb;
            --shadow: 0 2px 16px rgba(0,0,0,0.07);
            --radius: 12px;
            --font: 'Segoe UI', Arial, sans-serif;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            background: var(--bg);
            font-family: var(--font);
        }
        body {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            width: 100%;
            max-width: 420px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 2rem;
            color: var(--primary);
            letter-spacing: 1px;
        }
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 2rem 1.5rem 1.5rem 1.5rem;
            border: 1px solid var(--border);
        }
        .form-group {
            margin-bottom: 1.2rem;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #222;
        }
        input[type="color"], input[type="number"], select {
            width: 100%;
            padding: 0.5rem;
            border-radius: 6px;
            border: 1px solid var(--border);
            font-size: 1rem;
            background: #fafbfc;
        }
        input[type="color"] {
            padding: 0.2rem;
            height: 2.5rem;
        }
        .row {
            display: flex;
            gap: 1rem;
        }
        .row > .col {
            flex: 1;
        }
        button {
            width: 100%;
            padding: 0.75rem;
            background: var(--primary);
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        button:hover {
            background: var(--primary-hover);
        }
        .alert {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 6px;
            font-size: 1rem;
            background: #e0e7ff;
            color: #1e293b;
            border: 1px solid #c7d2fe;
            white-space: pre-wrap;
        }
        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-color: #6ee7b7;
        }
        .alert-danger {
            background: #fee2e2;
            color: #991b1b;
            border-color: #fecaca;
        }
        @media (max-width: 600px) {
            .container {
                padding: 0 0.5rem;
            }
            .card {
                padding: 1.2rem 0.7rem 1rem 0.7rem;
            }
            h1 {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Set color</h1>
        <div class="card">
            <form id="sensorForm" novalidate>
                <div class="row form-group">
                    <div class="col">
                        <label for="color">Barwa (RGB)</label>
                        <input type="color" id="color" value="#ff0000" title="Wybierz barwę RGB" required>
                    </div>
                    <div class="col">
                        <label for="speed">Set speed (ms)</label>
                        <input type="number" id="speed" min="10" max="60000" value="1000" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="modeFX">Efekt (modeFX)</label>
                    <select id="modeFX" required>
                        <option value="" disabled selected>Wybierz efekt</option>
                        <option value="0">FX_MODE_STATIC</option>
                        <option value="1">FX_MODE_WHITE_TO_COLOR</option>
                        <option value="2">FX_MODE_BLACK_TO_COLOR</option>
                        <option value="3">FX_MODE_BLINK</option>
                        <option value="4">FX_MODE_BLINK_RAINBOW</option>
                        <option value="5">FX_MODE_STROBE</option>
                        <option value="6">FX_MODE_STROBE_RAINBOW</option>
                        <option value="7">FX_MODE_BREATH</option>
                        <option value="8">FX_MODE_COLOR_WIPE</option>
                        <option value="9">FX_MODE_COLOR_WIPE_INV</option>
                        <option value="10">FX_MODE_COLOR_WIPE_REV</option>
                        <option value="11">FX_MODE_COLOR_WIPE_REV_INV</option>
                        <option value="12">FX_MODE_COLOR_WIPE_RANDOM</option>
                        <option value="13">FX_MODE_COLOR_SWEEP_RANDOM</option>
                        <option value="14">FX_MODE_RANDOM_COLOR</option>
                        <option value="15">FX_MODE_SINGLE_DYNAMIC</option>
                        <option value="16">FX_MODE_MULTI_DYNAMIC</option>
                        <option value="17">FX_MODE_RAINBOW</option>
                        <option value="18">FX_MODE_RAINBOW_CYCLE</option>
                        <option value="19">FX_MODE_FADE</option>
                        <option value="20">FX_MODE_SCAN</option>
                        <option value="21">FX_MODE_DUAL_SCAN</option>
                        <option value="22">FX_MODE_THEATER_CHASE</option>
                        <option value="23">FX_MODE_THEATER_CHASE_RAINBOW</option>
                        <option value="24">FX_MODE_RUNNING_LIGHTS</option>
                        <option value="25">FX_MODE_TWINKLE</option>
                        <option value="26">FX_MODE_TWINKLE_RANDOM</option>
                        <option value="27">FX_MODE_TWINKLE_FADE</option>
                        <option value="28">FX_MODE_TWINKLE_FADE_RANDOM</option>
                        <option value="29">FX_MODE_SPARKLE</option>
                        <option value="30">FX_MODE_FLASH_SPARKLE</option>
                        <option value="31">FX_MODE_HYPER_SPARKLE</option>
                        <option value="32">FX_MODE_MULTI_STROBE</option>
                        <option value="33">FX_MODE_CHASE_WHITE</option>
                        <option value="34">FX_MODE_CHASE_COLOR</option>
                        <option value="35">FX_MODE_CHASE_RANDOM</option>
                        <option value="36">FX_MODE_CHASE_RAINBOW</option>
                        <option value="37">FX_MODE_CHASE_FLASH</option>
                        <option value="38">FX_MODE_CHASE_FLASH_RANDOM</option>
                        <option value="39">FX_MODE_CHASE_RAINBOW_WHITE</option>
                        <option value="40">FX_MODE_CHASE_BLACKOUT</option>
                        <option value="41">FX_MODE_CHASE_BLACKOUT_RAINBOW</option>
                        <option value="42">FX_MODE_RUNNING_COLOR</option>
                        <option value="43">FX_MODE_RUNNING_RED_BLUE</option>
                        <option value="44">FX_MODE_RUNNING_RANDOM</option>
                        <option value="45">FX_MODE_LARSON_SCANNER</option>
                        <option value="46">FX_MODE_COMET</option>
                        <option value="47">FX_MODE_FIREWORKS</option>
                        <option value="48">FX_MODE_FIREWORKS_RANDOM</option>
                        <option value="49">FX_MODE_MERRY_CHRISTMAS</option>
                        <option value="50">FX_MODE_FIRE_FLICKER</option>
                        <option value="51">FX_MODE_FIRE_FLICKER_SOFT</option>
                        <option value="52">FX_MODE_FIRE_FLICKER_INTENSE</option>
                        <option value="53">FX_MODE_CIRCUS_COMBUSTUS</option>
                        <option value="54">FX_MODE_HALLOWEEN</option>
                        <option value="55">FX_MODE_BICOLOR_CHASE</option>
                        <option value="56">FX_MODE_TRICOLOR_CHASE</option>
                        <option value="57">FX_MODE_ICU</option>
                    </select>
                </div>
                <button type="button" onclick="sendData()">Wyślij dane</button>
            </form>
        </div>
        <div id="response" class="alert" style="display:none;"></div>
    </div>
    <script>
        // Form validation (prosta)
        function validate(form) {
            let valid = true;
            form.querySelectorAll("input, select").forEach(el => {
                if (!el.checkValidity()) valid = false;
            });
            return valid;
        }

        // HEX to RGB
        function hexToRgb(hex) {
            hex = hex.replace(/^#/, '');
            if (hex.length === 3) hex = hex.split('').map(x => x + x).join('');
            const num = parseInt(hex, 16);
            return { r: (num >> 16) & 255, g: (num >> 8) & 255, b: num & 255 };
        }

        async function sendData() {
            const form = document.getElementById('sensorForm');
            const responseDiv = document.getElementById('response');
            if (!validate(form)) {
                responseDiv.textContent = "Proszę uzupełnić wszystkie pola.";
                responseDiv.className = "alert alert-danger";
                responseDiv.style.display = "block";
                return;
            }
            const colorHex = document.getElementById('color').value;
            const colorRgb = hexToRgb(colorHex);
            const modeFX = parseInt(document.getElementById('modeFX').value, 10);
            const speed = parseInt(document.getElementById('speed').value, 10);
            const jsonData = {
                color: { hex: colorHex, rgb: colorRgb },
                modeFX: modeFX,
                speed: speed,
                timestamp: new Date().toISOString()
            };
            try {
                const response = await fetch('http://192.168.4.1/api', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(jsonData)
                });
                const data = await response.json();
                responseDiv.innerHTML = `<strong>Status:</strong> ${response.status}\n<strong>Response:</strong>\n${JSON.stringify(data, null, 2)}`;
                responseDiv.className = response.ok ? "alert alert-success" : "alert alert-danger";
                responseDiv.style.display = "block";
            } catch (error) {
                responseDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
                responseDiv.className = "alert alert-danger";
                responseDiv.style.display = "block";
            }
        }
    </script>
</body>
</html>
